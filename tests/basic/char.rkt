#lang racket/base

(define v #\u5c)
(displayln v)

(displayln (char? #\a))
(displayln (char? 1))
(displayln (char? '(#\a)))

(displayln (char? "x"))

(displayln (char<? #\a #\b))
(displayln (char<? #\a #\a))
(displayln (char<? #\b #\a))

; This will produce the wrong result in JavaScript if the implementation
; compares characters directly instead of looking at their codepoints.
(displayln (char<? #\ï¬† #\ðŒ†))

(displayln (char<=? #\a #\a))
(displayln (char<=? #\a #\b))
(displayln (char<=? #\b #\a))

(displayln (char>? #\a #\a))
(displayln (char>? #\a #\b))
(displayln (char>? #\b #\a))

(displayln (char>=? #\a #\a))
(displayln (char>=? #\a #\b))
(displayln (char>=? #\b #\a))

(displayln (char=? #\a #\a))
(displayln (char=? #\b #\a))
(displayln (char=? #\u10 #\newline))

(displayln (char->integer #\a))
(displayln (char->integer #\â˜º))

(displayln (integer->char 127874))

(displayln (char-utf-8-length #\a))
(displayln (char-utf-8-length #\ðŸŽ‚))

(println #\a)
(println #\tab)
(println #\ß†)

; This test requires a full implementation of isGraphicCodepoint to pass.
; (println #\ðŸŽ‚)


; Tests for every graphic codepoint in Unicode-10.0.0.
; This sequence was generated with:
; https://gist.github.com/glebm/2749c75b4fc4fed4dc5911925bb8f8b9

(define graphic-codepoints (in-sequences (in-range 33 127) (in-range 161 173) (in-range 174 888) (in-range 890 896) (in-range 900 907) 908 (in-range 910 930) (in-range 931 1328) (in-range 1329 1367) (in-range 1369 1376) (in-range 1377 1416) (in-range 1417 1419) (in-range 1421 1424) (in-range 1425 1480) (in-range 1488 1515) (in-range 1520 1525) (in-range 1542 1564) (in-range 1566 1757) (in-range 1758 1806) (in-range 1808 1867) (in-range 1869 1970) (in-range 1984 2043) (in-range 2048 2094) (in-range 2096 2111) (in-range 2112 2140) 2142 (in-range 2144 2155) (in-range 2208 2229) (in-range 2230 2238) (in-range 2260 2274) (in-range 2275 2436) (in-range 2437 2445) (in-range 2447 2449) (in-range 2451 2473) (in-range 2474 2481) 2482 (in-range 2486 2490) (in-range 2492 2501) (in-range 2503 2505) (in-range 2507 2511) 2519 (in-range 2524 2526) (in-range 2527 2532) (in-range 2534 2558) (in-range 2561 2564) (in-range 2565 2571) (in-range 2575 2577) (in-range 2579 2601) (in-range 2602 2609) (in-range 2610 2612) (in-range 2613 2615) (in-range 2616 2618) 2620 (in-range 2622 2627) (in-range 2631 2633) (in-range 2635 2638) 2641 (in-range 2649 2653) 2654 (in-range 2662 2678) (in-range 2689 2692) (in-range 2693 2702) (in-range 2703 2706) (in-range 2707 2729) (in-range 2730 2737) (in-range 2738 2740) (in-range 2741 2746) (in-range 2748 2758) (in-range 2759 2762) (in-range 2763 2766) 2768 (in-range 2784 2788) (in-range 2790 2802) (in-range 2809 2816) (in-range 2817 2820) (in-range 2821 2829) (in-range 2831 2833) (in-range 2835 2857) (in-range 2858 2865) (in-range 2866 2868) (in-range 2869 2874) (in-range 2876 2885) (in-range 2887 2889) (in-range 2891 2894) (in-range 2902 2904) (in-range 2908 2910) (in-range 2911 2916) (in-range 2918 2936) (in-range 2946 2948) (in-range 2949 2955) (in-range 2958 2961) (in-range 2962 2966) (in-range 2969 2971) 2972 (in-range 2974 2976) (in-range 2979 2981) (in-range 2984 2987) (in-range 2990 3002) (in-range 3006 3011) (in-range 3014 3017) (in-range 3018 3022) 3024 3031 (in-range 3046 3067) (in-range 3072 3076) (in-range 3077 3085) (in-range 3086 3089) (in-range 3090 3113) (in-range 3114 3130) (in-range 3133 3141) (in-range 3142 3145) (in-range 3146 3150) (in-range 3157 3159) (in-range 3160 3163) (in-range 3168 3172) (in-range 3174 3184) (in-range 3192 3204) (in-range 3205 3213) (in-range 3214 3217) (in-range 3218 3241) (in-range 3242 3252) (in-range 3253 3258) (in-range 3260 3269) (in-range 3270 3273) (in-range 3274 3278) (in-range 3285 3287) 3294 (in-range 3296 3300) (in-range 3302 3312) (in-range 3313 3315) (in-range 3328 3332) (in-range 3333 3341) (in-range 3342 3345) (in-range 3346 3397) (in-range 3398 3401) (in-range 3402 3408) (in-range 3412 3428) (in-range 3430 3456) (in-range 3458 3460) (in-range 3461 3479) (in-range 3482 3506) (in-range 3507 3516) 3517 (in-range 3520 3527) 3530 (in-range 3535 3541) 3542 (in-range 3544 3552) (in-range 3558 3568) (in-range 3570 3573) (in-range 3585 3643) (in-range 3647 3676) (in-range 3713 3715) 3716 (in-range 3719 3721) 3722 3725 (in-range 3732 3736) (in-range 3737 3744) (in-range 3745 3748) 3749 3751 (in-range 3754 3756) (in-range 3757 3770) (in-range 3771 3774) (in-range 3776 3781) 3782 (in-range 3784 3790) (in-range 3792 3802) (in-range 3804 3808) (in-range 3840 3912) (in-range 3913 3949) (in-range 3953 3992) (in-range 3993 4029) (in-range 4030 4045) (in-range 4046 4059) (in-range 4096 4294) 4295 4301 (in-range 4304 4681) (in-range 4682 4686) (in-range 4688 4695) 4696 (in-range 4698 4702) (in-range 4704 4745) (in-range 4746 4750) (in-range 4752 4785) (in-range 4786 4790) (in-range 4792 4799) 4800 (in-range 4802 4806) (in-range 4808 4823) (in-range 4824 4881) (in-range 4882 4886) (in-range 4888 4955) (in-range 4957 4989) (in-range 4992 5018) (in-range 5024 5110) (in-range 5112 5118) (in-range 5120 5760) (in-range 5761 5789) (in-range 5792 5881) (in-range 5888 5901) (in-range 5902 5909) (in-range 5920 5943) (in-range 5952 5972) (in-range 5984 5997) (in-range 5998 6001) (in-range 6002 6004) (in-range 6016 6110) (in-range 6112 6122) (in-range 6128 6138) (in-range 6144 6158) (in-range 6160 6170) (in-range 6176 6264) (in-range 6272 6315) (in-range 6320 6390) (in-range 6400 6431) (in-range 6432 6444) (in-range 6448 6460) 6464 (in-range 6468 6510) (in-range 6512 6517) (in-range 6528 6572) (in-range 6576 6602) (in-range 6608 6619) (in-range 6622 6684) (in-range 6686 6751) (in-range 6752 6781) (in-range 6783 6794) (in-range 6800 6810) (in-range 6816 6830) (in-range 6832 6847) (in-range 6912 6988) (in-range 6992 7037) (in-range 7040 7156) (in-range 7164 7224) (in-range 7227 7242) (in-range 7245 7305) (in-range 7360 7368) (in-range 7376 7418) (in-range 7424 7674) (in-range 7675 7958) (in-range 7960 7966) (in-range 7968 8006) (in-range 8008 8014) (in-range 8016 8024) 8025 8027 8029 (in-range 8031 8062) (in-range 8064 8117) (in-range 8118 8133) (in-range 8134 8148) (in-range 8150 8156) (in-range 8157 8176) (in-range 8178 8181) (in-range 8182 8191) (in-range 8208 8232) (in-range 8240 8287) (in-range 8304 8306) (in-range 8308 8335) (in-range 8336 8349) (in-range 8352 8384) (in-range 8400 8433) (in-range 8448 8588) (in-range 8592 9255) (in-range 9280 9291) (in-range 9312 11124) (in-range 11126 11158) (in-range 11160 11194) (in-range 11197 11209) (in-range 11210 11219) (in-range 11244 11248) (in-range 11264 11311) (in-range 11312 11359) (in-range 11360 11508) (in-range 11513 11558) 11559 11565 (in-range 11568 11624) (in-range 11631 11633) (in-range 11647 11671) (in-range 11680 11687) (in-range 11688 11695) (in-range 11696 11703) (in-range 11704 11711) (in-range 11712 11719) (in-range 11720 11727) (in-range 11728 11735) (in-range 11736 11743) (in-range 11744 11850) (in-range 11904 11930) (in-range 11931 12020) (in-range 12032 12246) (in-range 12272 12284) (in-range 12289 12352) (in-range 12353 12439) (in-range 12441 12544) (in-range 12549 12591) (in-range 12593 12687) (in-range 12688 12731) (in-range 12736 12772) (in-range 12784 12831) (in-range 12832 13055) (in-range 13056 19894) (in-range 19904 40939) (in-range 40960 42125) (in-range 42128 42183) (in-range 42192 42540) (in-range 42560 42744) (in-range 42752 42927) (in-range 42928 42936) (in-range 42999 43052) (in-range 43056 43066) (in-range 43072 43128) (in-range 43136 43206) (in-range 43214 43226) (in-range 43232 43262) (in-range 43264 43348) (in-range 43359 43389) (in-range 43392 43470) (in-range 43471 43482) (in-range 43486 43519) (in-range 43520 43575) (in-range 43584 43598) (in-range 43600 43610) (in-range 43612 43715) (in-range 43739 43767) (in-range 43777 43783) (in-range 43785 43791) (in-range 43793 43799) (in-range 43808 43815) (in-range 43816 43823) (in-range 43824 43878) (in-range 43888 44014) (in-range 44016 44026) (in-range 44032 55204) (in-range 55216 55239) (in-range 55243 55292) (in-range 63744 64110) (in-range 64112 64218) (in-range 64256 64263) (in-range 64275 64280) (in-range 64285 64311) (in-range 64312 64317) 64318 (in-range 64320 64322) (in-range 64323 64325) (in-range 64326 64450) (in-range 64467 64832) (in-range 64848 64912) (in-range 64914 64968) (in-range 65008 65022) (in-range 65024 65050) (in-range 65056 65107) (in-range 65108 65127) (in-range 65128 65132) (in-range 65136 65141) (in-range 65142 65277) (in-range 65281 65471) (in-range 65474 65480) (in-range 65482 65488) (in-range 65490 65496) (in-range 65498 65501) (in-range 65504 65511) (in-range 65512 65519) (in-range 65532 65534) (in-range 65536 65548) (in-range 65549 65575) (in-range 65576 65595) (in-range 65596 65598) (in-range 65599 65614) (in-range 65616 65630) (in-range 65664 65787) (in-range 65792 65795) (in-range 65799 65844) (in-range 65847 65935) (in-range 65936 65948) 65952 (in-range 66000 66046) (in-range 66176 66205) (in-range 66208 66257) (in-range 66272 66300) (in-range 66304 66340) (in-range 66349 66379) (in-range 66384 66427) (in-range 66432 66462) (in-range 66463 66500) (in-range 66504 66518) (in-range 66560 66718) (in-range 66720 66730) (in-range 66736 66772) (in-range 66776 66812) (in-range 66816 66856) (in-range 66864 66916) 66927 (in-range 67072 67383) (in-range 67392 67414) (in-range 67424 67432) (in-range 67584 67590) 67592 (in-range 67594 67638) (in-range 67639 67641) 67644 (in-range 67647 67670) (in-range 67671 67743) (in-range 67751 67760) (in-range 67808 67827) (in-range 67828 67830) (in-range 67835 67868) (in-range 67871 67898) 67903 (in-range 67968 68024) (in-range 68028 68048) (in-range 68050 68100) (in-range 68101 68103) (in-range 68108 68116) (in-range 68117 68120) (in-range 68121 68148) (in-range 68152 68155) (in-range 68159 68168) (in-range 68176 68185) (in-range 68192 68256) (in-range 68288 68327) (in-range 68331 68343) (in-range 68352 68406) (in-range 68409 68438) (in-range 68440 68467) (in-range 68472 68498) (in-range 68505 68509) (in-range 68521 68528) (in-range 68608 68681) (in-range 68736 68787) (in-range 68800 68851) (in-range 68858 68864) (in-range 69216 69247) (in-range 69632 69710) (in-range 69714 69744) (in-range 69759 69821) (in-range 69822 69826) (in-range 69840 69865) (in-range 69872 69882) (in-range 69888 69941) (in-range 69942 69956) (in-range 69968 70007) (in-range 70016 70094) (in-range 70096 70112) (in-range 70113 70133) (in-range 70144 70162) (in-range 70163 70207) (in-range 70272 70279) 70280 (in-range 70282 70286) (in-range 70287 70302) (in-range 70303 70314) (in-range 70320 70379) (in-range 70384 70394) (in-range 70400 70404) (in-range 70405 70413) (in-range 70415 70417) (in-range 70419 70441) (in-range 70442 70449) (in-range 70450 70452) (in-range 70453 70458) (in-range 70460 70469) (in-range 70471 70473) (in-range 70475 70478) 70480 70487 (in-range 70493 70500) (in-range 70502 70509) (in-range 70512 70517) (in-range 70656 70746) 70747 70749 (in-range 70784 70856) (in-range 70864 70874) (in-range 71040 71094) (in-range 71096 71134) (in-range 71168 71237) (in-range 71248 71258) (in-range 71264 71277) (in-range 71296 71352) (in-range 71360 71370) (in-range 71424 71450) (in-range 71453 71468) (in-range 71472 71488) (in-range 71840 71923) 71935 (in-range 72192 72264) (in-range 72272 72324) (in-range 72326 72349) (in-range 72350 72355) (in-range 72384 72441) (in-range 72704 72713) (in-range 72714 72759) (in-range 72760 72774) (in-range 72784 72813) (in-range 72816 72848) (in-range 72850 72872) (in-range 72873 72887) (in-range 72960 72967) (in-range 72968 72970) (in-range 72971 73015) 73018 (in-range 73020 73022) (in-range 73023 73032) (in-range 73040 73050) (in-range 73728 74650) (in-range 74752 74863) (in-range 74864 74869) (in-range 74880 75076) (in-range 77824 78895) (in-range 82944 83527) (in-range 92160 92729) (in-range 92736 92767) (in-range 92768 92778) (in-range 92782 92784) (in-range 92880 92910) (in-range 92912 92918) (in-range 92928 92998) (in-range 93008 93018) (in-range 93019 93026) (in-range 93027 93048) (in-range 93053 93072) (in-range 93952 94021) (in-range 94032 94079) (in-range 94095 94112) (in-range 94176 94178) (in-range 94208 100333) (in-range 100352 101107) (in-range 110592 110879) (in-range 110960 111356) (in-range 113664 113771) (in-range 113776 113789) (in-range 113792 113801) (in-range 113808 113818) (in-range 113820 113824) (in-range 118784 119030) (in-range 119040 119079) (in-range 119081 119155) (in-range 119163 119273) (in-range 119296 119366) (in-range 119552 119639) (in-range 119648 119666) (in-range 119808 119893) (in-range 119894 119965) (in-range 119966 119968) 119970 (in-range 119973 119975) (in-range 119977 119981) (in-range 119982 119994) 119995 (in-range 119997 120004) (in-range 120005 120070) (in-range 120071 120075) (in-range 120077 120085) (in-range 120086 120093) (in-range 120094 120122) (in-range 120123 120127) (in-range 120128 120133) 120134 (in-range 120138 120145) (in-range 120146 120486) (in-range 120488 120780) (in-range 120782 121484) (in-range 121499 121504) (in-range 121505 121520) (in-range 122880 122887) (in-range 122888 122905) (in-range 122907 122914) (in-range 122915 122917) (in-range 122918 122923) (in-range 124928 125125) (in-range 125127 125143) (in-range 125184 125259) (in-range 125264 125274) (in-range 125278 125280) (in-range 126464 126468) (in-range 126469 126496) (in-range 126497 126499) 126500 126503 (in-range 126505 126515) (in-range 126516 126520) 126521 126523 126530 126535 126537 126539 (in-range 126541 126544) (in-range 126545 126547) 126548 126551 126553 126555 126557 126559 (in-range 126561 126563) 126564 (in-range 126567 126571) (in-range 126572 126579) (in-range 126580 126584) (in-range 126585 126589) 126590 (in-range 126592 126602) (in-range 126603 126620) (in-range 126625 126628) (in-range 126629 126634) (in-range 126635 126652) (in-range 126704 126706) (in-range 126976 127020) (in-range 127024 127124) (in-range 127136 127151) (in-range 127153 127168) (in-range 127169 127184) (in-range 127185 127222) (in-range 127232 127245) (in-range 127248 127279) (in-range 127280 127340) (in-range 127344 127405) (in-range 127462 127491) (in-range 127504 127548) (in-range 127552 127561) (in-range 127568 127570) (in-range 127584 127590) (in-range 127744 128725) (in-range 128736 128749) (in-range 128752 128761) (in-range 128768 128884) (in-range 128896 128981) (in-range 129024 129036) (in-range 129040 129096) (in-range 129104 129114) (in-range 129120 129160) (in-range 129168 129198) (in-range 129280 129292) (in-range 129296 129343) (in-range 129344 129357) (in-range 129360 129388) (in-range 129408 129432) 129472 (in-range 129488 129511) (in-range 131072 173783) (in-range 173824 177973) (in-range 177984 178206) (in-range 178208 183970) (in-range 183984 191457) (in-range 194560 195102) (in-range 917760 918000)
))

(for ([codepoint graphic-codepoints])
  (let ([c (integer->char codepoint)])
    (displayln (format "~a ~a ~a" c (char-upcase c) (char-downcase c)))))
